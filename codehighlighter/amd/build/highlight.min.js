define(["jquery"],function(t){return{init:function(){console.log("highlight init"),jQuery.fn.parseCodeSplit=function(e,n){let i=t(this).html().split(/(<span.*?\/span>)/gi);for(let t=0;t<i.length;t+=2)i[t]=i[t].replace(e,'<span class="'+n+'">$1</span>');return i.join("")},jQuery.fn.parseCode=function(e,n){return t(this).html().replace(e,'<span class="'+n+'">$1</span>')},jQuery.fn.matchCode=function(e){let n=t(this).html().split(/(<span.*?\/span>)/gi);for(let t=0;t<n.length;t+=2)if(n[t].match(e))return!0;return!1},t("div[data-parser='JS']").each(function(){let e=t(this).attr("data-language");if(t.inArray(e,["cpp"])<0)return;let n=t(this).find("td:eq(1) pre");require(["filter_codehighlighter/"+e],function(e){if(null==e)return;let i=[];e.text.forEach(function(t,e){i.push("\\"+t+".*?\\"+t)});let l=new RegExp("("+i.join("|")+")","g"),h=[];for(let t in e.keywords)e.keywords.hasOwnProperty(t)&&h.push(new RegExp("\\b("+e.keywords[t].join("|")+")\\b",e.casesensitive[t]?"g":"gi"));let r=[];e.comment.forEach(function(t){r.push(t+".*")});for(let t=0;t<e.multicomment.length;t+=2)r.push(e.multicomment[t]+".*?"+e.multicomment[t+1]);n.each(function(e){t(this).html(t(this).parseCodeSplit(l,"text"))});for(let i=0;i<e.multicomment.length;i+=2){let l=0,h=e.multicomment[i],s=e.multicomment[i+1];n.each(function(e){l?(t(this).html(t(this).parseCode(new RegExp("(^.*?($|"+s+"))","g"),"multicomment")),t(this).html().match(new RegExp("("+s+")"),"g")&&(l=0)):t(this).html(t(this).parseCode(new RegExp("("+r.join("|")+")"),"comment"));let n=new RegExp("("+h+"((?!"+s+").)*$)","g");t(this).matchCode(n)&&(t(this).html(t(this).parseCode(n,"multicomment")),l=1)})}n.each(function(n){for(let e=0;e<h.length;++e)t(this).html(t(this).parseCodeSplit(h[e],"keyword"+(e+1)));t(this).html(t(this).parseCodeSplit(new RegExp("\\b("+e.number+")\\b","g"),"dec-number"))})})})}}});